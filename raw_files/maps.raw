<!--REMARK PHENIX TITLE START  Put your title here>


<H4><U>Creating maps and map coefficients with phenix.maps</U></H4>


<!--REMARK PHENIX TITLE END-->

<!--REMARK PHENIX BODY START   Put your text here.
Anything enclosed in header html H4 H5 etc will go in the table of contents>
<p><tt class="docutils literal"><span class="pre">phenix.maps</span></tt> is a simple command-line tool for calculating map coefficients
from a model and reflections file, with optional FFT to generate an actual
map file.  The program is largely self-documenting; this section essentially
reproduces the command-line output of the program when run without arguments.
As of PHENIX version 1.6.4, much of the parameter syntax is identical in
<tt class="docutils literal"><span class="pre">phenix.maps</span></tt> and <tt class="docutils literal"><span class="pre">phenix.refine</span></tt>.  There is also a <a class="reference" href="create_maps.htm">GUI for phenix.maps</a>, with separate documentation, but most of the information
below applies to both the command-line and graphical versions.</p>
<P><H5><U><B>How to run</B></U></H5><P>
<blockquote>
<ol>
<li>Run phenix.maps without any arguments: just type phenix.maps in the command
line and hit Enter. This will creare a parameter file called maps.params,
which can be renamed if desired.</li>
<li>Edit maps.params file to specify input/output file names, data labesl and
the desired maps. It is possible to request as many maps as desired. By
default, the file maps.params specifies 5 maps to be created: 2mFo-DFc,
2mFo-DFc with missing Fobs filled with DFcalc, mFo-DFc and anomalous
difference maps will be output in MTZ format, and one 2mFo-DFc map will be
output in X-plor formatted file.</li>
<li>Run this command to compute requested maps: phenix.maps maps.params</li>
</ol>
</blockquote>
<P><H5><U><B>Remarks</B></U></H5><P>
<blockquote>
<ul>
<li>The scope of parameters 'map_coefficients' defines the map that will be
output as Fourier map coefficients. The scope of parameters 'map' defines
the map that will be output as X-plor or CCP4 formatted map.</li>
<li>To create several maps: duplicate either 'map_coefficients' or 'map' or both
scopes of parameters as many times as many maps is desired. Then edit each
of them to define the maps.</li>
<li>A map is defined by specifying a map type using 'map_type' keyword available
within each scope of parameters: 'map_coefficients' or 'map'. The general
supported format for 'map_type' is: [p][m]Fo+[q][D]Fc[kick][filled]. For
example: 2Fo-Fc, 2mFobs-DFcalc, 3Fobs-2Fmodel, Fo-Fc, mfobs-Dfcalc, anom.
The 'map_type' parser will automatically recognize which map is requested.</li>
<li>The program creates an individual map file for each X-plor/CCP4 map
defined in the parameters, but it creates only one MTZ
formatted file with all Fourier map coefficients in it.</li>
<li>The X-plor formatted map can be computed in the entire unit cell or around
selected atoms only.</li>
<li>Kick maps and missing Fobs filling is done (if requested) as described in
Adams et al. (2010). Acta Cryst. D66, 213-221.</li>
<li>Twinning (if detected) will be accounted for automatically. This can be
disabled by using &quot;skip_twin_detection=True&quot; keyword.</li>
<li>All arrays used in map calculation, for example: Fobs, Fmodel, Fcalc, Fmask,
m, D, etc., can be output into a CNS or MTZ formatted reflection file.</li>
<li>For those who likes to experiment: bulk solvent correction and anisotropic
scaling can be turned off, the data can be filtered by sigma and resolution.</li>
</ul>
</blockquote>
<P><H5><U><B>FFT-ing map coefficients</B></U></H5><P>
<p>If you already have map coefficients in an MTZ file and just want to run an
FFT to produce X-plor or CCP4 map files, use <tt class="docutils literal"><span class="pre">phenix.mtz2map</span></tt>.  In most
cases this can be run automatically by passing the name of the MTZ file.
MTZ files generated by <tt class="docutils literal"><span class="pre">phenix.maps</span></tt>, <tt class="docutils literal"><span class="pre">phenix.refine</span></tt>, SOLVE/RESOLVE, and
REFMAC are supported, and additional combinations of map coefficients are
possible if defined by the user.  By default, output files will take the
base name of the MTZ file, with the appropriate map type appended if it
can be guessed from the column labels, otherwise a unique integer, followed
by the file type extension (.ccp4 or .xplor).</p>
<P><H5><U><B>Other map types</B></U></H5><P>
<p>The functionality in <tt class="docutils literal"><span class="pre">phenix.maps</span></tt> is intentionally kept simple, but
more complex map calculations may be performed in other programs:</p>
<blockquote>
<ul>
<li>For isomorphous difference maps (Fobs-Fobs),
use <tt class="docutils literal"><span class="pre">phenix.fobs_minus_fobs_map</span></tt> (documentation to be added).</li>
<li>For omit maps, including composite omit maps and iterative build omit
maps, use the <a class="reference" href="autobuild.htm">AutoBuild wizard</a>.</li>
<li>You can also generate a simple simulated-annealing omit map by deleting
the relevant part of the molecule and running <a class="reference" href="refinement.htm">phenix.refine</a> with <tt class="docutils literal"><span class="pre">simulated_annealing=True</span></tt>.  (This is essentially
the same was what is done by AutoBuild, however.)</li>
</ul>
</blockquote>
<!--REMARK PHENIX BODY END-->
