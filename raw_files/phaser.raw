 

<!--REMARK PHENIX TITLE START  Put your title here>

<H4><U>Phaser-2.1</U></H4>


<!--REMARK PHENIX TITLE END-->

<!--REMARK PHENIX BODY START   Put your text here.
Anything enclosed in header html H4 H5 etc will go in the table of contents>

<P><H5><U><B>Reference</B></U></H5<P>
      <li><em>J. Appl. Cryst.</em> (2007). <strong>40</strong>, 658-674. <a href="http://www-structmed.cimr.cam.ac.uk/Personal/randy/pubs/pubs.html#Phaser-2.1"><em>Phaser</em> crystallographic software.</a> A. J. McCoy, R. W. Grosse-Kunstleve, P. D. Adams, 
		M. D. Winn, L.C. Storoni and R.J. Read.<br>
</li>


  <P><H5><U><B>Tutorials and Example Files<a name="tutorial"></a></B></U></H5><P>

 <p> We thank Mike James and Natalie Strynadka for the BETA-BLIP test case diffraction data. Reference: 
Strynadka, N.C.J., Jensen, S.E., Alzari, P.M. &amp; James. M.N.G. (1996) <i>Nat. Struct. Biol.</i> <b>3</b> 290-297.
 We thank Paul Adams for the Insulin test case diffraction data.
Reference: Adams (2001) <i>Acta Cryst</i> D<b>57</b>. 990-995. </dd>

  <P><H5><U><B>Bug Reports</B></U></H5><P>
  
    We apologize for the bugs. Please send bug reports to<font face="Courier New, Courier, mono"> 
    <a href="mailto:cimr-phaser@lists.cam.ac.uk">cimr-phaser@lists.cam.ac.uk</a></font><br>
  
    <P><H5><U><B>General Strategy for Automated Molecular Replacement</B></U></H5><P>
<p>
      Automated Molecular Replacement in Phaser combines the anisotropy correction, likelihood enhanced 
      fast rotation function, likelihood enhanced fast translation function, packing 
      and refinement modes for multiple search models and a set of possible spacegroups. 
 </p>
<p>
 The PHENIX AutoMR wizard runs Phaser in default mode and allows some key changes to the default mode which may give structure solution in more difficult cases. 
Experience has shown that most structures that can be solved by Phaser can be solved by relatively simple strategies.
  However, if the AutoMR wizard doesn't give a solution even with non-default input you need to run Phaser outside the wizard to access the full range of Phaser control options.  This can be done in the <a href="phenix_gui.htm">PHENIX
graphical interface</a> by running the <a href="phaser_mr.htm">Phaser-MR GUI
</a>, or on the command line.
   Details of how to run Phaser using keyword input or from python scripts are found at <a href="http://www-structmed.cimr.cam.ac.uk/phaser">the Phaser home page</a>.
</p>
  <P><H5><U><B>How to Define Models</B></U></H5><P>
  
<p>
      Phaser must be given the models that it will use for molecular replacement. 
      A model in Phaser is referred to as an &quot;ensemble&quot;, even when it is described by a single   file. This is because it is possible to provide a set of aligned homologous structures as an ensemble, from which a statistically-weighted averaged model is calculated. A molecular replacement model is provided either 
      as one or more aligned pdb files, or as an electron density map, entered as structure factors 
      in an mtz file. Each ensemble is treated as a separate type of rigid body 
      to be placed in the molecular replacement solution. An ensemble should only 
      be defined once, even if there are several copies of the molecule in the 
      asymmetric unit.</p>
 <p>Fundamental to the way in which Phaser uses MR models (either from coordinates or maps) is to estimate 
    how the accuracy of the model falls off as a function of resolution, represented by the Sigma(A) curve. 
    To generate the Sigma(A) curve, Phaser needs to know the
      RMS coordinate error expected for the model and the fraction of the scattering power in the asymmetric unit
      that this model contributes.
 If fp is the fraction scattering and RMS is the rms coordinate 
      error, then<br>
      Sigma(A) = SQRT{fp*[1-fsol*exp(-Bsol*(sin(theta)/lambda)<sup>2</sup>)]} 
      * exp{-(8 Pi<sup>2</sup>/3)*RMS<sup>2</sup>*(sin(theta)/lambda)<sup>2</sup>}
<br>
      where fsol(default=0.95) and Bsol(default=300&Aring;<sup>2</sup>) account for the effects 
      of disordered solvent on the completeness of the model at low resolution.

    <P><H5>Building an Ensemble from Coordinates</H5><P>
      If you have an NMR Ensemble as a model, there is no need to split the coordinates 
        in the pdb file provided that the models are separated by MODEL and ENDMDL 
        cards. In this case the homology is not a good indication of the similarity 
        of the structural coordinates to the target structure. You should use 
        the RMS option; several test cases have succeeded where the ID was close to 100% with an RMS value of 
        about 1.5&Aring; (see table below). 
<p>
      The RMS deviation is entered directly or indirectly via the sequence identity (ID) using the formula RMS = max(0.8,0.4*exp(1.87*(1.0-ID))) where ID is the fraction identity.
      The RMS deviation estimated from ID may be an underestimate of the true value if there is a slight conformational
      change between the model and target structures. To find a solution in these cases it may be necessary to increase the
      RMS from the default value generated from the ID, by say 0.5 &Aring;ngstroms. On the other hand, when Phaser succeeds in solving a structure from a model with sequence identity much below 30%, it is often found that the fold is preserved better than the average for that level of sequence identity. So it may be worth submitting a run in which the RMS error is set at, say, 1.5, even if the sequence identity is low. The table below can be used as a
      guide as to the default RMS value corresponding to ID.</p>
    <table border="1" align="center" cellspacing="0" cellpadding="0">
      <tr> 
        <td> <div align="center"><b>&nbsp;&nbsp;Sequence ID&nbsp;&nbsp;</b></div> </td>
        <td> <div align="center"><b>&nbsp;&nbsp;RMS deviation&nbsp;&nbsp;</b></div> </td>
      </tr>
      <tr> 
        <td> <div align="center">100%</div> </td>
        <td> <div align="center">0.80&Aring;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">64%</div> </td>
        <td> <div align="center">0.80&Aring;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">63%</div> </td>
        <td> <div align="center">0.799&Aring;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">50%</div> </td>
        <td> <div align="center">1.02&Aring;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">40%</div> </td>
        <td> <div align="center">1.23&Aring;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">30%</div> </td>
        <td> <div align="center">1.48&Aring;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">20%</div> </td>
        <td> <div align="center">1.78&Aring;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">--&gt; limit 0%</div> </td>
        <td> <div align="center">2.60&Aring;</div> </td>
      </tr>
    </table>
    <p>If you construct a model by homology modelling, remember that the RMS error 
      you expect is essentially the error you expect from the template structure (if not worse!). 
      So specify the sequence identity of the template, not of the homology model.
    </p>
  
  <P><H5><U><B>How to Define Composition</B></U></H5><P>

<p>
The composition defines the total amount of protein and nucleic acid that you have in the asymmetric unit <U>not the fraction of the asymmetric unit that you are searching for.</U>
  You can mix compositions entered by molecular weight with those entered by sequence.
</p>
<p>
    <P><H5>Composition by Molecular Weight</H5><P>
<p>
The composition is calculated from the molecular weight of the protein and nucleic acid assuming the protein and nucleic acid have the average distribution of amino acids and bases. If your protein or nucleic acid has an unusual amino acid or base distribution the composition should be entered by sequence.
  You can mix compositions entered by molecular weight with those entered by sequence.</p>
    <P><H5>Composition by Sequence</H5><P>
<p>
The composition is calculated from the amino acid sequence of the protein and the base sequence of the nucleic acid in fasta format.
  <P><H5><U><B>How to Select Peaks</B></U></H5><P>
  
    If the AutoMR wizard fails to find a solution with default input, a solution may be found by changing the default selection criteria for peaks from the rotation function that are carried through to the translation funciton. The selection criterion can be changed by choosing the "edit rarely used inputs" option in the wizard.
    Selection can be done in four different ways.
</p>
    <P><H5>Select by Percent</H5><P>
        <p> Percentage of the top peak, where the value of the top peak is defined as
             100% and the value of the mean is defined as 0%.
         Default cutoff is 75%. This criteria has the advantange that at least one peak (the top peak) always survives the selection.
             If the top solution is clear, then only the one solution will be output, but if the distribution of
             peaks is rather flat, then many peaks will be output for testing in the next
             part of the MR procedure (e.g. many peaks selected from
             the rotation function for testing with a translation function).  </p>
        <P><H5>Select by Z-Score</H5><P>
        <p> Number of standard deviations (sigmas) over the mean (the Z-score). This is an
         absolute significance test. Not all searches will produce output if the 
             cutoff value is too high (e.g. 5 sigma).  </p>
      <P><H5>Select by Number</H5><P>
      <p> Number of top peaks to select.
       If the distribution is very flat then it might be better to select a fixed
          large number (e.g. 1000) of top rotation peaks for testing in the translation function.  </p>
      <P><H5>Select All</font></H5><P>
      <p> All peaks are selected.
      Enables full 6 dimensional searches, where all the solutions from the rotation
          function are output for testing in the translation function. This
          should never be necessary; it would be much faster and probably just as likely
          to work if the top 1000 peaks were used in this way.  </p>
 
  <P><H5><U><B>Has Phaser Solved It?</B></U></H5><P>
  
    <p>Ideally, only the number of solutions you are expecting should be found.
      However if the signal-to-noise of your search is low, there will be noise peaks in the final selection also.
    </p>
    <p><font color="#DD00DD">A highly compact summary of the history of a solution is given in the annotation of
      a solution in the .sol file.</font> This is a good place to start your analysis of the output. The annotation gives the Z-score of the solution at each
      rotation and translation function, the number of clashes in the packing, and the refined LLG. You should see the TFZ (the translation function Z-score) is high at least for the final components of the solution, and that the LLG (log-likelihood gain) increases as each component of the solution is added. For example, in the case of beta-blip the annotation for the single solution output in the .sol file shows these features
    </p>
<p><font face="Courier New, Courier, mono">
SOLU SET <font color="#DD00DD"> RFZ=11.0 TFZ=22.6 PAK=0 LLG=434 RFZ=6.2 TFZ=28.9 PAK=0 LLG=986 LLG=986</font><br>
SOLU 6DIM ENSE beta EULER  200.920   41.240  183.776 FRAC -0.49641 -0.15752 -0.28125<br>
SOLU 6DIM ENSE blip EULER   43.873   80.949  117.141 FRAC -0.12290  0.29306 -0.09193<br>
</font>
</p>
    <table border="1" align="center" cellspacing="0" cellpadding="0">
      <tr> 
        <td> <div align="center"><b>&nbsp;TF Z-score&nbsp;</b></div> </td>
        <td> <div align="center"><b>&nbsp;Have I solved it?&nbsp;</b></div> </td>
      </tr>
      <tr> 
        <td> <div align="center">&nbsp;less than 5&nbsp;</div> </td>
        <td> <div align="center">&nbsp;no&nbsp;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">&nbsp;5 - 6&nbsp; </div> </td>
        <td> <div align="center">&nbsp;unlikely&nbsp;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">&nbsp;6 - 7&nbsp;</div> </td>
        <td> <div align="center">&nbsp;possibly&nbsp;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">&nbsp;7 - 8&nbsp; </div> </td>
        <td> <div align="center">&nbsp;probably&nbsp;</div> </td>
      </tr>
      <tr> 
        <td> <div align="center">&nbsp;more than 8&nbsp; </div> </td>
        <td> <div align="center">&nbsp;definitely*&nbsp;</div> </td>
      </tr>
    </table>
    <p> For a rotation function, the correct 
      solution may be in the list with a Z-score under 4, and will not be found 
      until a translation function is performed and picks out the correct solution. 
    </p>
    <p> 
      For a translation function the correct solution will generally have a Z-score 
      (number of standard deviations above the mean value) over 5 and be well 
      separated from the rest of the solutions.
    Of course, there will always be exceptions! *Note, in particular, that in 
      the presence of translational NCS, pairs of similarly-oriented molecules 
      separated by the correct translation vector will give large Z-scores, even 
      if they are incorrect, because they explain the systematic variation in 
      intensities caused by the translational NCS. 
    </p>
    <p>You should always at least glance through the summary of the logfile. One thing 
      to look for, in particular, is whether any translation solutions with a 
      high Z-score have been rejected by the packing step. By default up to 10 clashes are allowed. Such a solution may be correct, and the 
      clashes may arise only because of differences in small surface loops. If 
      this happens, repeat the run allowing a suitable number of clashes. Note that, unless there is specific evidence in the logfile that
      a high TF-function Z-score solution is being rejected with a few clashes, it is much better
      to edit the model to remove the loops than to increase the number of allowed clashes. Packing criteria
      are a very powerful constraint on the translation function, and increasing the number of allowed clashes 
      beyond the default will increase the search time enormously without the possibility of generating any
      correct solutions that would not have otherwise been found.</p>
  
  <P><H5><U><B>What to do in difficult cases</B></U></H5><P>
  
    Not every structure can be solved by molecular replacement, but the right 
    strategy can push the limits. What to do when the default jobs fail depends 
    on why your structure is difficult. 
    <P><H5>Flexible Structure</H5><P>
    <p>The relative orientations of the domains may be different in your crystal 
      than in the model. If that may be the case, break the model into separate 
      PDB files containing rigid-body units, enter these as separate ensembles, 
      and search for them separately. 
      </p>
    <p>Alternatively, you could try generating a series of models perturbed by 
      normal modes. One of these 
      may duplicate the hinge motion and provide a good single model.</p>
    <P><H5>Poor or Incomplete Model</H5><P>
    <p>Signal-to-noise is reduced by coordinate errors or incompleteness of the 
      model. Since the rotation search has lower signal to begin with than the 
      translation search, it is usually more severely affected. For this reason, 
      it can be very useful to use the subsequent translation search as a way 
      to choose among many (say 1000) orientations. Try increasing the number 
      of clustered orientations. 
      If that fails, try turning off the clustering feature in the save step, 
      because the correct orientation may sit on the shoulder of a peak in the 
      rotation function. </p>
    <p>As shown convincingly by Schwarzenbacher <i>et al.</i> (Schwarzenbacher, 
      Godzik, Grzechnik &amp; Jaroszewski, <i>Acta Cryst.</i> D<b>60</b>, 1229-1236, 
      2004), judicious editing can make a significant difference in the quality 
      of a distant model. In a number of tests with their data on models below 
      30% sequence identity, we have found that Phaser works best with a &quot;mixed 
      model&quot; (non-identical sidechains longer than Ser replaced by Ser). 
      In agreement with their results, the best models are generally derived using 
      more sophisticated alignment protocols, such as their FFAS protocol.</p>
    <P><H5>High Degree of Non-crystallographic Symmetry</H5><P>
    If there are clear peaks in the self-rotation function, you can expect orientations 
    to be related by this known NCS.
    Alternatively, you may have an oligomeric 
    model and expect similar NCS in the crystal. First search with the oligomeric 
    model; if this fails, search with a monomer. 
    <P><H5>Pseudo-translational Non-crystallographic Symmetry</H5><P>
    It is frequently the case that crystallographic and non-crystallographic rotational 
    symmetry axes are parallel. The combination generates translational NCS, in 
    which more than one unique copy of the molecule is found in the same orientation 
    in the crystal. This can be recognized by the presence of large non-origin 
    peaks in the native Patterson map. If one copy of the search model can be 
    found, then the translational NCS tells you where to place another copy. Unfortunately, 
    the presence of translational NCS can make it difficult to solve a structure 
    using Phaser, because the current likelihood targets do not account for the 
    statistical effects of NCS. If there is a small difference in the orientation 
    of the two molecules (which will show up as a reduction in the height of the 
    non-origin Patterson peak as the resolution is increased), it may help to 
    use data to higher resolution than the default, because the translational 
    NCS is partially broken. 
    <P><H5>What <u>not</u> to do</H5><P>
      <p>The automated mode of Phaser is fast when Phaser finds a high Z-score solution to your problem. When Phaser cannot find
      a solution with a significant Z-score, it &quot;thrashes&quot;, meaning it maintains a list of 100-1000's of low Z-score potential solutions
      and tries to improve them. This can lead to exceptionally long Phaser runs (over a week of
      CPU time). Such runs are possible because the highly automated script allows many consecutive MR jobs to be run without 
      you having to manually set 100-1000's of jobs running and keep track of the results. &quot;Thrashing&quot; generally does not produce a solution:
      solutions generally appear relatively quickly or not at all. It is more useful to go back and analyse your models and your data to see 
      where improvements can be made. Your system manager will appreciate you terminating these jobs. </p>
      <p>It is also not a good idea to effectively remove the packing test.  Unless there is specific evidence in the logfile that
      a high TF-function Z-score solution is being rejected with a few clashes, it is much better
      to edit the model to remove the loops than to increase the number of allowed clashes. Packing criteria
      are a very powerful constraint on the translation function, and increasing the number of allowed clashes
      beyond the default (10) will increase the search time enormously without the possibility of generating any
      correct solutions that would not have otherwise been found.
     </p>
    <P><H5>Other suggestions</H5><P>
<p>
     Phaser has powerful input, output and scripting facilities that allow a large number of possibilities for altering default 
     behaviour and forcing 
     Phaser to do what you think it should. However, you will need to read the information at <a href="http://www-structmed.cimr.cam.ac.uk/phaser">the Phaser home page</a> to take 
     advantage of these facilities!
</p>

  
<!--REMARK PHENIX BODY END-->

