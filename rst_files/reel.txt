Restraints Editor Especially Ligands (REEL)
===========================================

Restraints Editor Especially Ligands (REEL)
===========================================

Author
------

Nigel W. Moriarty

Purpose
-------

Edit the geometry restraints of a ligand using a Graphical User
Interface (GUI) including a 3D view of the ligand and a tabular view of
the restraints.

Screen Shots
------------

|image0|

|image1|

|image2|

General Procedure
-----------------

The general procedure is to load a restraints file (CIF) and manipulate
the restraints via the table or molecule view. The geometry of the
revised restraints can be tested using the Action->Geometry optimisation
option. The final restraints can be saved to a CIF file for use with
phenix.refine. The corresponding PDB file can also be saved.

Input
-----

Restraints can be loaded into REEL using the command line, the pull-down
menu to open a file and a pull-down menu to run eLBOW. Restraints files
from eLBOW contain both the restraints and cartesian coordinates. For
the purposes of REEL, the coordinates are generated by the restraints
and can not be edited directly. The background colour is light steel
blue to show that it is not used in the geometry editing actions.

REEL can load a molecule geometry from any format the eLBOW can read,
including PDB, Mol2D and SDF. If the file does not contain the bonding
information, the bonding is automatically determined using proximity.
The limit on the size of molecule that the bonding is automatically
determined is set at 200 atoms.

Molecule up to 2000 atoms can be loaded using the --view but only the
bond connectivity is determined. The bond order is set to one but can be
changed interactively.

Molecules can be loaded into REEL using the --reel option for eLBOW or
using the eLBOW GUI dialog available in REEL.

The Chemical Components database can also be accessed using the --chem
option so load the cartesian coordinates and atom names of a certain
ligand.

The --smiles option will automatically run eLBOW on the SMILES string
and load the CIF file in REEL.

It may be that a CIF without cartesian coordinates is the file to be
loaded. REEL will load it and attempt but its better to provide the
cartesian coordinates. A simple way is to use:

::

    phenix.reel ligand.cif ligand.pdb

and to use the --overlay option to force it in the case of slightly
different ligand details (ligand code).

Editing
-------

The geometry restraints (bonds, angles, dihedrals, planes and chirals)
are the driving coordinates in this editor. The cartesian coordinates
are displayed in the atoms table only because there are generated for
the viewer display. They are the driven coordinates and are therefore
ignored if changed in the editor.

Many cells in the table view of the restraints can be changed but care
must be taken to ensure that the changes are local or global. For
example, changing an atom name in the bonds table view will only change
it in that row. If you wish to change the name of the atom in all the
restraints for should use the right mouse menu in the viewer window or
change it in the atoms table view. The colour of the cell gives the
impression as to whether the changes are propagated elsewhere. The
cells, in some cases, have not been made read only to allow the user to
make changes as desired.

Clicking an atom in the molecule view will highlight the various related
topological elements in the table view and vice versa. Use the checkbox
in the table view or a right-mouse pop-menu to remove a restraint from
optimisation and output file. Chiral centres can be changed in the table
view.

Right clicking in the viewer or in the table view provide pop-menu for
various actions. Examples are below.

|image3| |image4|

Double clicking the label headers will sort the rows.

Menus
-----

File
    

|image5|

REEL can open a large number of file formats but the best file is the
CIF output from eLBOW. Using the menu or the shortcut will provide a
dialog to choose an input file.

The template input allows for the transfer of atom names from a PDB to
the molecule in the viewer

|image6|

Two different cartesian options for overlaying onto the molecule in the
viewer are in the "Cartesian coordinate inputs" sub-menu. The main
difference is the adjustment of the restraints' ideal value from the
input geometry.

|image7|

The saving options include a data sheet which is a postscript file
including a two-dimensional representation of the molecule.

The view defaults including the window size and position, the molecular
representation (atom labels and bond view) and background can be managed
using the "View defaults" menu items.

View
    

|image8|

View options in include toggling the hydrogens, the background, the
labels on the atoms ...

|image9|

and showing the bond orders.

|image10|

The listing of the geometry allows the ideal restraint values and the
actual geometric values to be displayed. Any actual values more than
three sigma the estimated standard deviations are highlighted.

The 2D options shows a 2-dimensional resprestation of the molecule.

Action
      

|image11|

Geometry optimisation using a simple force field can be perform using
the first option. This is also available in the toolbar as is the
semi-empirical quantum method, AM1, optimisation using the eLBOW dialog.

The last three options will open the eLBOW dialog with either no
defaults, the file initially loaded for the molecule or the current CIF
restraints, respectively. Once the eLBOW job is finished the user is
promoted to choose what to do with the results.

|image12|

"Geometry transfer" will update the cartesian coordiantes of the
molecule while the "Geometry and restraints transfer" will update the
ideal values of the restraints. The former can be combined with the View
-> "List geometry values" menu option to see the differences.

Examples
--------

To load a previously created restraints file

::

    phenix.reel atp.cif

To load a restraints file into REEL from eLBOW

::

    phenix.elbow --smiles O --reel

To load all the unknown ligands from a PDB file

::

    phenix.reel model.pdb --do-all

or a single residue

::

    phenix.reel model.pdb --residue ATP

.. |image0| image:: images/reel_restraints_atoms.png
.. |image1| image:: images/reel_viewer.png
.. |image2| image:: images/reel_elbow_dialog.png
.. |image3| image:: images/reel_right_atom_pop.png
.. |image4| image:: images/reel_right_table_pop.png
.. |image5| image:: images/reel_file_menu.png
.. |image6| image:: images/reel_cartesian_sub_menu.png
.. |image7| image:: images/reel_2d_view.png
.. |image8| image:: images/reel_view_menu.png
.. |image9| image:: images/reel_atom_sub_menu.png
.. |image10| image:: images/reel_bond_sub_menu.png
.. |image11| image:: images/reel_action_menu.png
.. |image12| image:: images/reel_geometry_transfer.png
