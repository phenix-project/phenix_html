phenix.pdbtools: PDB model manipulations and statistics
-------------------------------------------------------

**Manipulations on a model in a PDB file including**

The operations below can be applied to the whole model or selected parts
(e.g. "selection=chain A and backbone"). See examples below.

- shaking of coordinates (random coordinate shifts)
- rotation-translation shift of coordinates
- shaking of occupancies
- set occupancies to a value
- shaking of ADP
- shifting of ADP (addition of a constant value)
- scaling of ADP (multiplication by a constant value)
- setting ADP to a given value
- conversion to isotropic ADP
- conversion to anisotropic ADP
- removal of selected parts of a model

**Comprehensive model statistics**

- Atomic Displacement parameters (ADP) statistics::

  % phenix.pdbtools model.pdb --show-adp-statistics

- Geometry (stereochemistry) statistics::

  % phenix.pdbtools model.pdb --show-geometry-statistics

In the absence of a CRYST1 record in the PDB file, functionality
that doesn't require knowledge of the crystal symmetry is still
available. To enable the full functionality, the crystal symmetry
can be specified externally (e.g. via the --symmetry option).

**Add hydrogen atoms**

Add H atoms to a model using phenix.reduce. All default parameters of
phenix.reduce are used.

**Perform model geometry regularization**

Minimize geometry target to idealize bond lenghths, bond angles, planarities,
chiralities, dihedrals, and non-bonded interactions.

**Examples**

**1)** Type ``phenix.pdbtools`` from the command line for instructions::

  % phenix.pdbtools

**2)** To see all default parameters::

  % phenix.pdbtools --show-defaults=all

**3)** Suppose a PDB model consist of three chains A, B and C and some water
molecules. Remove all atoms in chain C and all waters::

  % phenix.pdbtools model.pdb remove="chain C or water"

or one can achieve exactly the same result with equivalent command::

  % phenix.pdbtools model.pdb keep="chain A or chain B"

or::

  % phenix.pdbtools model.pdb keep="not(chain C or water)"

or finally::

  % phenix.pdbtools model.pdb remove="not(chain A or chain B)"

The result of all four equivalent commands above will be a new PDB file
containing chains A and B only. Important: the commands ``keep`` and
``remove`` cannot be used simultaneously.

**4)** Remove all but backbone atoms and set all b-factors to 25::

  % phenix.pdbtools model.pdb keep=backbone set_b_iso=25

**5)** Suppose a PDB model consist of three chains A, B and C and some water
molecules. Remove all but backbone atoms and set b-factors to 25 for chain C
atoms::

  % phenix.pdbtools model.pdb keep=backbone set_b_iso=25 selection="chain C"

**6)** Add H atoms to a model::

  % phenix.pdbtools model.pdb --add_h output.file_name=model_h.pdb

**7)** Model geometry regularization::

  % phenix.pdbtools model.pdb --geometry_regularization
