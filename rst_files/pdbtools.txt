=======================================================
phenix.pdbtools: PDB model manipulations and statistics
=======================================================

**Purpose**

``phenix.pdbtools`` is a command-line tool for performing simple
manipulations on a model in a PDB file including:

- shaking of coordinates (random coordinate shifts)
- rotation-translation shift of coordinates
- shaking of occupancies
- shaking of ADP
- shifting of ADP (addition of a constant value)
- scaling of ADP (multiplication by a constant value)
- setting ADP to a given value
- conversion to isotropic ADP
- conversion to anisotropic ADP
- removal of selected parts of a model

The operations can be applied to the whole model or selected parts
(e.g. "selection=chain A and backbone").

In addition, ``phenix.pdbtools`` provides comprehensive model
statistics:

- ADP statistics::

  % phenix.pdbtools model.pdb --show-adp-statistics

- Geometry (stereochemistry) statistics::

  % phenix.pdbtools model.pdb --show-geometry-statistics

In the absence of a CRYST1 record in the PDB file, functionality
that doesn't require knowledge of the crystal symmetry is still
available. To enable the full functionality, the crystal symmetry
can be specified externally (e.g. via the --symmetry option).

**How to run**

Type ``phenix.pdbtools`` from the command line for instructions::

  % phenix.pdbtools

**To see all default parameters**::

  % phenix.pdbtools --show-defaults=all

**Examples**

Suppose a PDB model consist of three chains A, B and C and some water molecules.

1) Remove all atoms in chain C and all waters::

   % phenix.pdbtools model.pdb remove="chain C or water"

   or one can achieve exactly the same result with equivalent command::

   % phenix.pdbtools model.pdb keep="chain A or chain B"

   or::

   % phenix.pdbtools model.pdb keep="not(chain C or water)"

   or finally::

   % phenix.pdbtools model.pdb remove="not(chain A or chain B)"


   The result of all four equivalent commands above will be a new PDB file
   containing chains A and B only. Important: the commands ``keep`` and
   ``remove`` cannot be used simultaneously.

2) Remove all but backbone atoms and set all b-factors to 25::

   % phenix.pdbtools model.pdb keep=backbone set_b_iso=25

3) Remove all but backbone atoms and set b-factors to 25 for chain C atoms::

   % phenix.pdbtools model.pdb keep=backbone set_b_iso=25 selection="chain C"
