===================================
About Phenix-supported file formats
===================================

This document provides an introduction to the types of files used by (or
generated by) Phenix.  Most of these formats are also used by other software,
but we have emphasized the most popular file types.

.. _model_formats:

Model files
-----------

.. _pdb_format:

Models are represented primarily as a series of records for each atom, plus
associated metadata such as crystal symmetry.  The most common format in
macromolecular crystallography is the **PDB format**, which might look like
this::

  ATOM      1  CA AILE A   1       9.968  51.572  -0.800  1.00 20.69           N
  ATOM      2  CA BILE A   1       8.566  51.700  -0.272  1.00 21.30           C  HETATM 2545 ZN    ZN A1317      36.762  44.115  -7.277  1.00 15.32          ZN
  HETATM 2557  O   HOH A2001      10.269  53.403  -3.264  1.00 27.45           O

 
Implicit in this information is a hierarchy of chains (with ID "A" in this
case), residues (denoted by unique numbers), and atoms.  Each residue may have
multiple conformations (such as the isoleucine residue above, which has "A" and
"B" conformers).  The individual atom records have columns for the XYZ
coordinates, occupancy, isotropic B-factor, and element symbol.  (They also
include a "serial number" - the first numerical column - but this is not
usually used in Phenix.)  If the structure is refined with anisotropic
displacements (either for individual atoms, or TLS parameters), relevant
atoms may be followed by an ANISOU record.  Note that atoms may be denoted by
either ATOM (for standard amino acid and nucleic acid residues) or HETATM
(for waters, ions, ligands, and non-standard polymer residues).  Most programs
do not distinguish between these record types.

Besides atom information, the PDB format also usually includes a CRYST1
record specifying the unit cell and space group, and some number of REMARK
records containing metadata such as refinement statistics, TLS matrices,
and information about program use.  The crystal symmetry is important for
many applications, but the REMARK section is usually ignored (except for
deposition with the PDB).

If you need to edit a PDB file, we recommend that you use either
`PDBTools <pdbtools.htm>`_, a non-interactive tool available both on the
command line and the graphical interface, or phenix.pdb_editor, an interactive
graphical editor.  Editing by hand is strongly discouraged and often leads to
program errors.

.. _mmcif_format:

In some programs in Phenix (in particular `phenix.refine <refine_gui.htm>`_),
support is also provided for reading and writing mmCIF files.  This is a
variation on CIF format (described in detail below) specific to macromolecular
models and data.  mmCIF is considerably more complicated than PDB format, and
less human-readable, but it is also much more flexible and better-defined.
In the future, all PDB depositions will be done using mmCIF format, but for
now PDB files remain the primary model format during the structure
determination process.

See the wwPDB site for full documentation on the `PDB format
<http://www.wwpdb.org/docs.html#format>`_ and `mmCIF <http://mmcif.wwpdb.org>`_.

.. _reflections:

Reflection files
----------------

Experimental data may be stored in a variety of formats.  Some of these may
include additional information, described below.  In each format, a list of
"Miller indices" (h, k, l) is associated with one or more data fields, but
the exact contents vary widely.

.. _mtz:

Currently, the best-supported format in Phenix and other macromolecular
crystallography software is **MTZ format**, which was developed as part of the
`CCP4 project <http://ccp4.ac.uk>`_.  These are binary files (not
human-readable), which makes them especially compact and fast.  MTZ files
may contain any number of experimental datasets, R-free flags, phases, or
map coefficients.  Each field has a unique column label; in Phenix, these
are usually grouped together, for instance "F(+),SIGF(+),F(-),SIGF(-)" groups
four columns from an MTZ file specifying the Friedel mates for experimental
amplitudes and estimated error, and "2FOFCWT,PH2FOFCWT" specifies the
amplitudes and phases for a 2mFo-DFC map.  MTZ files will always explicitly
specify the crystal symmetry, and include a field for the wavelength of
each dataset (although this may not always be reliable).

In Phenix, every program that reads or writes reflection data supports MTZ
format; these files should usually be compatible with other software such as
CCP4 or Coot.  (Note however that the wavelength output by Phenix programs
may be incorrect, but this is not widely used.)  Nearly any MTZ file is
suitable as input, except for the raw output of Mosflm, which contains
intensities that have not yet been scaled.

Several other formats are supported in various contexts.  Some of these
differ in whether individual observations of each unique reflection have
been merged or not (see the separate
documentation on `using unmerged data in Phenix <unmerged_data.htm>`_ for
more details), but all of these should contain **scaled** data.  Only CNS
format can include R-free flags; the rest are usually the output of data
processing programs and require additional processing to be useful, and
will ultimately be converted to MTZ format.

.. _cns:

**CNS** format is text, and is the primary input and output format of
the `program of the same name <http://cns-online.org>`_.  It may include any
combination of data, but usually this will be amplitudes or intensities plus
R-free flags.

.. _scalepack:

**Scalepack** format is a text format output by the data processing
software HKL2000.  It only includes experimental intensities, with or
without Friedel pairs.  Crystal symmetry is explicitly supplied.

.. _scalepack_unmerged:

**Unmerged Scalepack** format is also produced by HKL2000, but includes
unmerged intensities and additional data processing information.  This is
used by several programs (including SOLVE), but it has the disadvantage of
lacking the unit cell parameters.

.. _shelx:

**SHELX** format is an even simpler text format.  We do not recommend
using this if possible, because it doesn ot explicitly specify either the
crystal symmetry or the data type (amplitudes or intensities).

.. _xds:

**XDS** format is also text, specifying experimental intensities and
associated information from data processing.  XDS actually outputs several
different types of files, but the most appropriate will nearly always be
named "XDS_ASCII.HKL".  These files contain crystal symmetry information and
may include either merged or unmerged data.

If you need to edit or combine reflection files, Phenix includes a
`graphical editor <reflection_file_editor.htm>`_ which supports all of these
formats.  However, output is limited to MTZ.
